# Прогнозирование качества молока и удоев коров с помощью линейных моделей

##  О проекте

Проект по разработке моделей машинного обучения для молочного хозяйства "Вольный луг". Созданы две прогнозные модели:
- **Регрессионная модель** для прогнозирования годового удоя коров
- **Классификационная модель** для определения вкусовых качеств молока

##  Цели проекта

- Разработать модель прогнозирования удоя с точностью R² > 0.8
- Создать классификатор вкуса молока с оптимальным балансом precision/recall
- Отобрать коров, соответствующих критериям фермера: удой ≥6000 кг/год и вкусное молоко
- Снизить риски при покупке новых коров

##  Данные

### Основные датасеты:
- **ferma_main.csv** - данные о текущем стаде фермера (1000+ записей)
- **ferma_dad.csv** - информация о родителях коров
- **cow_buy.csv** - данные коров для потенциальной покупки

### Ключевые признаки:
- **Характеристики коровы**: Порода, возраст, порода отца
- **Параметры корма**: ЭКЕ, сырой протеин, СПО
- **Условия содержания**: Тип пастбища
- **Качество молока**: Удой, жирность, белок, вкус

##  Технологии

- **Python 3.8+**
- **Pandas** - обработка и анализ данных
- **NumPy** - математические операции
- **Scikit-learn** - машинное обучение
- **Matplotlib/Seaborn** - визуализация
- **Phik** - анализ корреляций
- **SciPy** - статистический анализ

##  Ключевые этапы работы

### 1. Предобработка данных
- Удаление явных и неявных дубликатов
- Корректировка типов данных
- Обработка пропущенных значений
- Визуальный анализ распределений

### 2. Исследовательский анализ
- Корреляционный анализ признаков
- Выявление нелинейных зависимостей
- Анализ взаимосвязей между параметрами корма и удоем

### 3. Feature Engineering
- Преобразование нелинейных признаков (СПО → бинарный)
- Добавление новых признаков (ЭКЕ²)
- Обогащение данных информацией о родителях

### 4. Построение моделей

#### Регрессия (Удой):
- **Модель 1**: R² = 0.78
- **Модель 2**: R² = 0.83 (после преобразования признаков)
- **Модель 3**: R² = 0.84 (с добавлением информации о родителях)

#### Классификация (Вкус молока):
- **Accuracy**: 0.61
- **Precision**: 0.62
- **Recall**: 0.79
- **Оптимальный порог**: 0.80

##  Результаты

### Корреляционный анализ показал:
- Наибольшее влияние на удой: параметры корма (ЭКЕ, протеин, СПО)
- На вкус молока влияют: содержание белка и жирность

### Отбор коров для покупки:
Из всего стада "ЭкоФермы" только **2 коровы** соответствуют критериям:
- Удой ≥6000 кг/год
- Высокое качество вкуса молока

##  Рекомендации фермеру

### Для минимизации рисков:
1. **Приобрести только 2 коровы** (индексы 0 и 11), соответствующих всем критериям
2. **Мониторить параметры корма** - ключевой фактор удоя
3. **Уделять внимание genetics** - порода и lineage влияют на продуктивность

### Для дальнейшего улучшения моделей:
1. **Сбор дополнительных данных** о условиях содержания
2. **Временной анализ** продуктивности коров
3. **Эксперименты с составом корма** для оптимизации показателей

##  Метрики качества

### Регрессионная модель:
- **R²**: 0.84
- **MSE**: 112 500
- **MAE**: 95 кг
- **RMSE**: 335 кг

### Классификационная модель:
- **Accuracy**: 0.61
- **Precision**: 0.62
- **Recall**: 0.79
- **F1-Score**: 0.69
